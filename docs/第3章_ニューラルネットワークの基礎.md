# ç¬¬3ç« ï¼šãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®åŸºç¤

ã“ã®ç« ã§ã¯ã€LLMã®åŸºç›¤ã¨ãªã‚‹**ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯**ã®ç†è«–ã‚’å­¦ã³ã¾ã™ã€‚è„³ã®ç¥çµŒç´°èƒã‹ã‚‰ãƒ’ãƒ³ãƒˆã‚’å¾—ãŸå˜ç´”ãªãƒ¢ãƒ‡ãƒ«ãŒã€ã©ã®ã‚ˆã†ã«è¤‡é›‘ãªé–¢æ•°ã‚’å­¦ç¿’ã§ãã‚‹ã®ã‹ã‚’ç†è§£ã—ã¦ã„ãã¾ã™ã€‚

---

## 3.1 ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ã¨ç·šå½¢åˆ†é›¢å¯èƒ½æ€§

### 3.1.1 ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ã®èª•ç”Ÿ

**æ­´å²ï¼š**

1958å¹´ã€ãƒ•ãƒ©ãƒ³ã‚¯ãƒ»ãƒ­ãƒ¼ã‚¼ãƒ³ãƒ–ãƒ©ãƒƒãƒˆãŒ**ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³**ã‚’ç™ºæ˜ã€‚äººå·¥çŸ¥èƒ½ã®æœ€åˆã®ä¸€æ­©ã€‚

**ç”Ÿç‰©å­¦çš„ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ï¼š**

```
è„³ã®ç¥çµŒç´°èƒï¼ˆãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ï¼‰
        æ¨¹çŠ¶çªèµ·
         â†“ â†“ â†“  å…¥åŠ›ä¿¡å·
         â—â”€â”€â”€â”€â†’  ç´°èƒä½“ã§çµ±åˆ
        /|\       â†“
              è»¸ç´¢ã‚’é€šã˜ã¦å‡ºåŠ›
              
è¤‡æ•°ã®å…¥åŠ› â†’ çµ±åˆ â†’ å‡ºåŠ›
```

### 3.1.2 ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ã®ãƒ¢ãƒ‡ãƒ«

**æ•°å­¦çš„å®šç¾©ï¼š**

å…¥åŠ› $\mathbf{x} = (x_1, x_2, \ldots, x_n)$ ã«å¯¾ã—ã¦ï¼š

$$y = \begin{cases}
1 & \text{if } \sum_{i=1}^{n} w_ix_i + b \geq 0 \\
0 & \text{otherwise}
\end{cases}$$

ã¾ãŸã¯ã€æ´»æ€§åŒ–é–¢æ•°ã‚’ä½¿ã£ã¦ï¼š

$$y = \sigma\left(\sum_{i=1}^{n} w_ix_i + b\right) = \sigma(\mathbf{w}^\top\mathbf{x} + b)$$

ã“ã“ã§ï¼š
- $\mathbf{x}$ï¼šå…¥åŠ›ãƒ™ã‚¯ãƒˆãƒ«
- $\mathbf{w}$ï¼šé‡ã¿ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰
- $b$ï¼šãƒã‚¤ã‚¢ã‚¹ï¼ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰
- $\sigma$ï¼šæ´»æ€§åŒ–é–¢æ•°ï¼ˆä¾‹ï¼šã‚¹ãƒ†ãƒƒãƒ—é–¢æ•°ï¼‰

**è¦–è¦šåŒ–ï¼ˆ2å…¥åŠ›ã®å ´åˆï¼‰ï¼š**

```
å…¥åŠ›å±¤        å‡ºåŠ›å±¤
  xâ‚ â”€wâ‚â”€â”
          â”œâ”€â†’ Î£ â”€â†’ Ïƒ â”€â†’ y
  xâ‚‚ â”€wâ‚‚â”€â”˜
    
   b â”€â”€â”€â”€â”€â”€â”˜ (ãƒã‚¤ã‚¢ã‚¹)
```

**ç›´æ„Ÿçš„ç†è§£ï¼š**

> ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ã¯ã€Œé‡ã¿ä»˜ãæŠ•ç¥¨æ©Ÿã€  
> å„å…¥åŠ›ã«é‡ã¿ã‚’æ›ã‘ã¦åˆè¨ˆã—ã€é–¾å€¤ã‚’è¶…ãˆãŸã‚‰ç™ºç«

### 3.1.3 ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ã®å¹¾ä½•å­¦çš„è§£é‡ˆ

**2æ¬¡å…ƒã®ä¾‹ï¼š**

$$w_1x_1 + w_2x_2 + b = 0$$

ã“ã‚Œã¯å¹³é¢ä¸Šã®ç›´ç·šï¼

**è¦–è¦šåŒ–ï¼š**

```
xâ‚‚
 â†‘
 |  â—‹ â—‹ â—‹  (ã‚¯ãƒ©ã‚¹1)
 |  â—‹ â—‹
 |â”€â”€â”€â”€â”€â”€â”€â”€â”€  æ±ºå®šå¢ƒç•Œ: wâ‚xâ‚ + wâ‚‚xâ‚‚ + b = 0
 |    Ã— Ã—
 |    Ã— Ã— Ã—  (ã‚¯ãƒ©ã‚¹0)
 +â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ xâ‚
```

ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ã¯**ç·šå½¢åˆ†é¡å™¨**ï¼šç›´ç·šï¼ˆã¾ãŸã¯è¶…å¹³é¢ï¼‰ã§ã‚¯ãƒ©ã‚¹ã‚’åˆ†é›¢

**3æ¬¡å…ƒã®å ´åˆï¼š**

æ±ºå®šå¢ƒç•Œã¯å¹³é¢ã«ãªã‚‹

```
   xâ‚ƒ
    â†‘
   /|\
  / | \  å¹³é¢ã§2ã¤ã®ã‚¯ãƒ©ã‚¹ã‚’åˆ†é›¢
 /  |  \
+â”€â”€â”€â”€â”€â”€â”€â†’ xâ‚‚
  â†™
 xâ‚
```

### 3.1.4 ç·šå½¢åˆ†é›¢å¯èƒ½æ€§

**å®šç¾©ï¼š**

ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒ**ç·šå½¢åˆ†é›¢å¯èƒ½**ã§ã‚ã‚‹ã¨ã¯ã€ç›´ç·šï¼ˆè¶…å¹³é¢ï¼‰ã§2ã¤ã®ã‚¯ãƒ©ã‚¹ã‚’å®Œå…¨ã«åˆ†é›¢ã§ãã‚‹ã“ã¨

**ä¾‹1ï¼šANDã‚²ãƒ¼ãƒˆï¼ˆç·šå½¢åˆ†é›¢å¯èƒ½ï¼‰**

| $x_1$ | $x_2$ | AND |
|-------|-------|-----|
| 0     | 0     | 0   |
| 0     | 1     | 0   |
| 1     | 0     | 0   |
| 1     | 1     | 1   |

**è¦–è¦šåŒ–ï¼š**
```
xâ‚‚
1 | 0      1
  |    â•±
0 | 0 â•±    
  +â”€â”€â”€â”€â”€â”€
  0  1   xâ‚
  
æ±ºå®šå¢ƒç•Œ: xâ‚ + xâ‚‚ - 1.5 = 0
```

é‡ã¿ï¼š $w_1 = 1, w_2 = 1, b = -1.5$

**ä¾‹2ï¼šXORã‚²ãƒ¼ãƒˆï¼ˆç·šå½¢åˆ†é›¢ä¸å¯èƒ½ï¼‰**

| $x_1$ | $x_2$ | XOR |
|-------|-------|-----|
| 0     | 0     | 0   |
| 0     | 1     | 1   |
| 1     | 0     | 1   |
| 1     | 1     | 0   |

**è¦–è¦šåŒ–ï¼š**
```
xâ‚‚
1 | 0      1
  |   ï¼Ÿ
0 | 1      0
  +â”€â”€â”€â”€â”€â”€
  0  1   xâ‚
  
ç›´ç·šã§ã¯åˆ†é›¢ä¸å¯èƒ½ï¼
```

**ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ã®é™ç•Œï¼š**

> 1å±¤ã®ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ã¯ã€ç·šå½¢åˆ†é›¢å¯èƒ½ãªå•é¡Œã—ã‹è§£ã‘ãªã„

ã“ã®é™ç•ŒãŒ1960-70å¹´ä»£ã®AIå†¬ã®æ™‚ä»£ã‚’æ‹›ã„ãŸã€‚

### 3.1.5 ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³å­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

**ç›®çš„ï¼š** æ­£ã—ãåˆ†é¡ã§ãã‚‹é‡ã¿ $\mathbf{w}, b$ ã‚’è¦‹ã¤ã‘ã‚‹

**ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼š**

```
1. é‡ã¿ w, ãƒã‚¤ã‚¢ã‚¹ b ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«åˆæœŸåŒ–
2. å„è¨“ç·´ãƒ‡ãƒ¼ã‚¿ (x, t) ã«å¯¾ã—ã¦ï¼š
   a. äºˆæ¸¬: y = Ïƒ(w^T x + b)
   b. èª¤å·®: e = t - y
   c. æ›´æ–°: 
      w â† w + Î·Â·eÂ·x
      b â† b + Î·Â·e
3. ã™ã¹ã¦æ­£ã—ãåˆ†é¡ã§ãã‚‹ã¾ã§ç¹°ã‚Šè¿”ã—
```

ã“ã“ã§ $\eta$ ã¯å­¦ç¿’ç‡ã€ $t$ ã¯æ­£è§£ãƒ©ãƒ™ãƒ«

**åæŸå®šç†ï¼ˆRosenblatt, 1962ï¼‰ï¼š**

> ãƒ‡ãƒ¼ã‚¿ãŒç·šå½¢åˆ†é›¢å¯èƒ½ãªã‚‰ã€ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³å­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯æœ‰é™å›ã§åæŸã™ã‚‹

**å…·ä½“ä¾‹ï¼š**

è¨“ç·´ãƒ‡ãƒ¼ã‚¿ï¼š
- $(x_1, x_2, t) = (0, 0, 0), (0, 1, 0), (1, 0, 0), (1, 1, 1)$ï¼ˆANDï¼‰

åˆæœŸå€¤ï¼š $w_1 = 0, w_2 = 0, b = 0$, $\eta = 0.1$

**æ›´æ–°ã®æ§˜å­ï¼š**

```
ã‚¨ãƒãƒƒã‚¯1:
(0,0,0): y=0, æ­£è§£ âœ“
(0,1,0): y=0, æ­£è§£ âœ“
(1,0,0): y=0, æ­£è§£ âœ“
(1,1,1): y=0, èª¤ã‚Š âœ—
  â†’ wâ‚ = 0 + 0.1Ã—1Ã—1 = 0.1
  â†’ wâ‚‚ = 0 + 0.1Ã—1Ã—1 = 0.1
  â†’ b  = 0 + 0.1Ã—1   = 0.1

ã‚¨ãƒãƒƒã‚¯2ä»¥é™ã§å¾ã€…ã«åæŸ...
```

---

## 3.2 å¤šå±¤ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ã¨æ±ç”¨è¿‘ä¼¼å®šç†

### 3.2.1 å¤šå±¤ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ï¼ˆMLPï¼‰

**ã‚¢ã‚¤ãƒ‡ã‚¢ï¼š**

> XORå•é¡Œã‚’è§£ãã«ã¯ã€ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ã‚’**é‡ã­ã‚‹**ï¼ˆå±¤ã‚’å¢—ã‚„ã™ï¼‰

**2å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼š**

```
å…¥åŠ›å±¤   éš ã‚Œå±¤   å‡ºåŠ›å±¤
  xâ‚ â”€â”€â”¬â”€â†’ hâ‚ â”€â”€â”
       â”‚         â”œâ”€â†’ y
  xâ‚‚ â”€â”€â”´â”€â†’ hâ‚‚ â”€â”€â”˜
```

**æ•°å¼ï¼š**

éš ã‚Œå±¤ï¼š
$$h_j = \sigma\left(\sum_i w_{ij}^{(1)}x_i + b_j^{(1)}\right)$$

å‡ºåŠ›å±¤ï¼š
$$y = \sigma\left(\sum_j w_j^{(2)}h_j + b^{(2)}\right)$$

**ãƒ™ã‚¯ãƒˆãƒ«å½¢å¼ï¼š**

$$\mathbf{h} = \sigma(\mathbf{W}^{(1)}\mathbf{x} + \mathbf{b}^{(1)})$$
$$y = \sigma(\mathbf{w}^{(2)\top}\mathbf{h} + b^{(2)})$$

### 3.2.2 XORå•é¡Œã®è§£æ±º

**2å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§XORã‚’å®Ÿè£…ï¼š**

**æ§‹é€ ï¼š**
- å…¥åŠ›ï¼š2ãƒãƒ¼ãƒ‰ $(x_1, x_2)$
- éš ã‚Œå±¤ï¼š2ãƒãƒ¼ãƒ‰
- å‡ºåŠ›ï¼š1ãƒãƒ¼ãƒ‰

**é‡ã¿ã®è¨­å®šï¼š**

éš ã‚Œå±¤ï¼š
$$h_1 = \sigma(x_1 + x_2 - 0.5) \quad \text{ï¼ˆORã‚²ãƒ¼ãƒˆï¼‰}$$
$$h_2 = \sigma(-2x_1 - 2x_2 + 3) \quad \text{ï¼ˆNANDã‚²ãƒ¼ãƒˆï¼‰}$$

å‡ºåŠ›å±¤ï¼š
$$y = \sigma(h_1 + h_2 - 1.5) \quad \text{ï¼ˆANDã‚²ãƒ¼ãƒˆï¼‰}$$

**çœŸç†å€¤è¡¨ï¼š**

| $x_1$ | $x_2$ | $h_1$ (OR) | $h_2$ (NAND) | $y$ (AND) | XOR |
|-------|-------|------------|--------------|-----------|-----|
| 0     | 0     | 0          | 1            | 0         | 0   |
| 0     | 1     | 1          | 1            | 1         | 1   |
| 1     | 0     | 1          | 1            | 1         | 1   |
| 1     | 1     | 1          | 0            | 0         | 0   |

æˆåŠŸï¼ âœ“

**å¹¾ä½•å­¦çš„è§£é‡ˆï¼š**

```
éš ã‚Œå±¤ã§éç·šå½¢å¤‰æ›
   â†“
ç‰¹å¾´ç©ºé–“ãŒæ­ªã‚€
   â†“
ç·šå½¢åˆ†é›¢å¯èƒ½ã«ãªã‚‹
```

### 3.2.3 æ±ç”¨è¿‘ä¼¼å®šç†

**å®šç†ï¼ˆCybenko, 1989ï¼‰ï¼š**

æœ‰é™å€‹ã®ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ã‚’æŒã¤1å±¤ã®éš ã‚Œå±¤ã§ã€ä»»æ„ã®é€£ç¶šé–¢æ•°ã‚’ä»»æ„ã®ç²¾åº¦ã§è¿‘ä¼¼ã§ãã‚‹

**æ•°å­¦çš„è¡¨ç¾ï¼š**

ä»»æ„ã®é€£ç¶šé–¢æ•° $f: [0,1]^n \to \mathbb{R}$ ã¨ $\epsilon > 0$ ã«å¯¾ã—ã¦ã€

$$g(\mathbf{x}) = \sum_{j=1}^{m} v_j\sigma\left(\sum_{i=1}^{n}w_{ji}x_i + b_j\right)$$

ãŒå­˜åœ¨ã—ã¦ã€

$$\sup_{\mathbf{x} \in [0,1]^n} |f(\mathbf{x}) - g(\mathbf{x})| < \epsilon$$

**ç›´æ„Ÿçš„ç†è§£ï¼š**

> ã€Œãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯ä¸‡èƒ½é–¢æ•°è¿‘ä¼¼å™¨ã€

**1æ¬¡å…ƒã§ã®è¦–è¦šåŒ–ï¼š**

ç›®æ¨™é–¢æ•° $f(x) = \sin(x)$ ã‚’è¿‘ä¼¼

```
f(x) = sin(x)
    â•±â€¾â€¾â•²
   â•±    â•²  â•±
  â•±      â•²â•±

ReLUã®çµ„ã¿åˆã‚ã›ã§è¿‘ä¼¼:
  _â•±â€¾â•²_
 â•±    â•²_â•±
```

å„éš ã‚Œãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ãŒã€ŒæŠ˜ã‚Œç·šã€ã‚’ä½œã‚Šã€ãã‚Œã‚‰ã‚’è¶³ã—åˆã‚ã›ã‚‹ã“ã¨ã§è¤‡é›‘ãªæ›²ç·šã‚’è¿‘ä¼¼

**é‡è¦ãªæ³¨æ„ç‚¹ï¼š**

1. **å­˜åœ¨å®šç†**ï¼šè¿‘ä¼¼ã§ãã‚‹ã“ã¨ã¯ä¿è¨¼ã™ã‚‹ãŒã€è¦‹ã¤ã‘ã‚‹æ–¹æ³•ã¯ä¿è¨¼ã—ãªã„
2. **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•°**ï¼šç²¾åº¦ã‚’ä¸Šã’ã‚‹ã«ã¯å¤šãã®ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ãŒå¿…è¦
3. **æ·±ã•ã®åˆ©ç‚¹**ï¼šæ·±ã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®æ–¹ãŒåŠ¹ç‡çš„ï¼ˆå¾Œè¿°ï¼‰

### 3.2.4 æ·±ã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®åˆ©ç‚¹

**å®šç†ï¼ˆTelgarsky, 2016ï¼‰ï¼š**

ç‰¹å®šã®é–¢æ•°æ—ã«å¯¾ã—ã¦ã€æ·±ã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯æŒ‡æ•°çš„ã«å°‘ãªã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§è¿‘ä¼¼å¯èƒ½

**ä¾‹ï¼š**

é–¢æ•° $f(x) = x^{2^k}$ ã‚’è¿‘ä¼¼

- æµ…ã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆ1éš ã‚Œå±¤ï¼‰ï¼š $O(2^k)$ ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³å¿…è¦
- æ·±ã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆkå±¤ï¼‰ï¼š $O(k)$ ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ã§ååˆ†

**ç›´æ„Ÿçš„ç†è§£ï¼š**

```
æµ…ã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼š
ã™ã¹ã¦ã‚’ä¸€åº¦ã«å­¦ç¿’ â†’ éåŠ¹ç‡

æ·±ã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼š
éšå±¤çš„ã«ç‰¹å¾´ã‚’æŠ½å‡º â†’ åŠ¹ç‡çš„

ä¾‹ï¼ˆç”»åƒèªè­˜ï¼‰:
å±¤1: ã‚¨ãƒƒã‚¸æ¤œå‡º
å±¤2: å½¢çŠ¶æ¤œå‡º  
å±¤3: éƒ¨å“æ¤œå‡º
å±¤4: ç‰©ä½“èªè­˜
```

**LLMã§ã®å¿œç”¨ï¼š**

GPT-3: 96å±¤ã€å„å±¤ãŒç•°ãªã‚‹ãƒ¬ãƒ™ãƒ«ã®è¨€èªç‰¹å¾´ã‚’å­¦ç¿’

---

## 3.3 æ´»æ€§åŒ–é–¢æ•°ã®æ€§è³ª

### 3.3.1 æ´»æ€§åŒ–é–¢æ•°ã®å½¹å‰²

**ãªãœå¿…è¦ã‹ï¼š**

æ´»æ€§åŒ–é–¢æ•°ãŒãªã„ã¨ï¼š

$$y = \mathbf{W}^{(2)}(\mathbf{W}^{(1)}\mathbf{x}) = \underbrace{(\mathbf{W}^{(2)}\mathbf{W}^{(1)})}_{\text{1ã¤ã®è¡Œåˆ—}}\mathbf{x}$$

â†’ ä½•å±¤é‡ã­ã¦ã‚‚ç·šå½¢å¤‰æ›ã®ã¾ã¾ï¼

**æ´»æ€§åŒ–é–¢æ•°ã®å½¹å‰²ï¼š**

> éç·šå½¢æ€§ã‚’å°å…¥ã—ã€è¤‡é›‘ãªé–¢æ•°ã‚’è¡¨ç¾å¯èƒ½ã«ã™ã‚‹

### 3.3.2 ä¸»è¦ãªæ´»æ€§åŒ–é–¢æ•°

#### 1. ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°

**å®šç¾©ï¼š**

$$\sigma(x) = \frac{1}{1 + e^{-x}}$$

**ã‚°ãƒ©ãƒ•ï¼š**
```
Ïƒ(x)
1   |        ______
    |      /
0.5 |     /
    |   /
0   |__/___________
    -5  0  5      x
```

**æ€§è³ªï¼š**
- å€¤åŸŸï¼š $(0, 1)$
- æ»‘ã‚‰ã‹ï¼ˆå¾®åˆ†å¯èƒ½ï¼‰
- å‡ºåŠ›ã‚’ç¢ºç‡ã¨ã—ã¦è§£é‡ˆå¯èƒ½

**å°é–¢æ•°ï¼š**

$$\sigma'(x) = \sigma(x)(1 - \sigma(x))$$

è¨ˆç®—ãŒç°¡å˜ï¼

**å•é¡Œç‚¹ï¼š**
- **å‹¾é…æ¶ˆå¤±**ï¼š $|x|$ ãŒå¤§ãã„ã¨ $\sigma'(x) \approx 0$
- å‡ºåŠ›ãŒ0ä¸­å¿ƒã§ãªã„ï¼ˆå¾Œè¿°ï¼‰

#### 2. tanhï¼ˆåŒæ›²ç·šæ­£æ¥ï¼‰

**å®šç¾©ï¼š**

$$\tanh(x) = \frac{e^x - e^{-x}}{e^x + e^{-x}} = 2\sigma(2x) - 1$$

**ã‚°ãƒ©ãƒ•ï¼š**
```
tanh(x)
 1  |        ______
    |      /
 0  |â”€â”€â”€â”€â”€/â”€â”€â”€â”€â”€â”€â”€â”€
    |   /
-1  |__/___________
    -5  0  5      x
```

**æ€§è³ªï¼š**
- å€¤åŸŸï¼š $(-1, 1)$
- 0ä¸­å¿ƒï¼ˆã‚·ã‚°ãƒ¢ã‚¤ãƒ‰ã‚ˆã‚Šè‰¯ã„ï¼‰
- ä¾ç„¶ã¨ã—ã¦å‹¾é…æ¶ˆå¤±ã®å•é¡Œ

**å°é–¢æ•°ï¼š**

$$\tanh'(x) = 1 - \tanh^2(x)$$

#### 3. ReLUï¼ˆRectified Linear Unitï¼‰

**å®šç¾©ï¼š**

$$\text{ReLU}(x) = \max(0, x) = \begin{cases} x & \text{if } x > 0 \\\ 0 & \text{otherwise} \end{cases}$$

**ã‚°ãƒ©ãƒ•ï¼š**
```
ReLU(x)
    |    â•±
    |   â•±
    |  â•±
    | â•±
____|â•±___________
    0           x
```

**æ€§è³ªï¼š**
- è¨ˆç®—ãŒè¶…é«˜é€Ÿ
- å‹¾é…æ¶ˆå¤±ã—ãªã„ï¼ˆæ­£ã®é ˜åŸŸï¼‰
- ç”Ÿç‰©å­¦çš„å¦¥å½“æ€§ï¼ˆç¥çµŒç´°èƒã®ç™ºç«ï¼‰

**å°é–¢æ•°ï¼š**

$$\text{ReLU}'(x) = \begin{cases} 1 & \text{if } x > 0 \\\ 0 & \text{if } x \leq 0 \end{cases}$$

**åˆ©ç‚¹ï¼š**
1. âœ… è¨ˆç®—åŠ¹ç‡
2. âœ… å‹¾é…æ¶ˆå¤±ã‚’è»½æ¸›
3. âœ… ã‚¹ãƒ‘ãƒ¼ã‚¹æ€§ï¼ˆå¤šãã®ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ãŒ0ï¼‰

**å•é¡Œç‚¹ï¼š**
- **Dying ReLU**ï¼š $x < 0$ ã§å‹¾é…ãŒ0 â†’ ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ãŒæ­»ã¬

#### 4. Leaky ReLU

**å®šç¾©ï¼š**

$$\text{Leaky ReLU}(x) = \max(\alpha x, x) = \begin{cases} x & \text{if } x > 0 \\\ \alpha x & \text{otherwise} \end{cases}$$

é€šå¸¸ $\alpha = 0.01$

**ã‚°ãƒ©ãƒ•ï¼š**
```
Leaky ReLU
    |    â•±
    |   â•±
    |  â•±
    | â•±
___â•±|___________
 â•±  0          x
```

**æ”¹å–„ç‚¹ï¼š**
- è² ã®é ˜åŸŸã§ã‚‚å°ã•ãªå‹¾é… â†’ Dying ReLUå•é¡Œã‚’è»½æ¸›

#### 5. GELUï¼ˆGaussian Error Linear Unitï¼‰

**å®šç¾©ï¼š**

$$\text{GELU}(x) = x \cdot \Phi(x)$$

ã“ã“ã§ $\Phi(x)$ ã¯æ¨™æº–æ­£è¦åˆ†å¸ƒã®ç´¯ç©åˆ†å¸ƒé–¢æ•°

**è¿‘ä¼¼å¼ï¼š**

$$\text{GELU}(x) \approx 0.5x\left(1 + \tanh\left(\sqrt{\frac{2}{\pi}}\left(x + 0.044715x^3\right)\right)\right)$$

**ã‚°ãƒ©ãƒ•ï¼š**
```
GELU(x)
    |    â•±
    |   â•± (ReLUã‚ˆã‚Šæ»‘ã‚‰ã‹)
    |  â•±
    | â•±
    |â•±___________
   â•±0           x
```

**æ€§è³ªï¼š**
- ReLUã¨tanhã®è‰¯ã„ã¨ã“å–ã‚Š
- æ»‘ã‚‰ã‹ãªéç·šå½¢æ€§
- **æœ€æ–°ã®LLMã§æ¨™æº–çš„**ï¼ˆGPTã€BERTãªã©ï¼‰

**ãªãœLLMã§äººæ°—ï¼š**
- ç¢ºç‡çš„ãªè§£é‡ˆï¼ˆæ­£è¦åˆ†å¸ƒã«åŸºã¥ãï¼‰
- æ»‘ã‚‰ã‹ãªå‹¾é…
- çµŒé¨“çš„ã«æ€§èƒ½ãŒè‰¯ã„

### 3.3.3 æ´»æ€§åŒ–é–¢æ•°ã®æ¯”è¼ƒ

| é–¢æ•° | å€¤åŸŸ | å‹¾é…æ¶ˆå¤± | è¨ˆç®—é€Ÿåº¦ | LLMã§ã®ä½¿ç”¨ |
|------|------|----------|----------|-------------|
| Sigmoid | (0,1) | âœ— å¼·ã„ | é…ã„ | Ã— |
| tanh | (-1,1) | âœ— å¼·ã„ | é…ã„ | â–³ |
| ReLU | [0,âˆ) | âœ“ è»½æ¸› | é€Ÿã„ | â—‹ |
| Leaky ReLU | (-âˆ,âˆ) | âœ“ è»½æ¸› | é€Ÿã„ | â—‹ |
| GELU | (-âˆ,âˆ) | âœ“ è»½æ¸› | ä¸­ç¨‹åº¦ | â— |

**LLMã§ã®å…¸å‹çš„ãªé¸æŠï¼š**
- **Transformer**ï¼šGELUï¼ˆGPTã€BERTãªã©ï¼‰
- **ä¸€éƒ¨ã®ãƒ¢ãƒ‡ãƒ«**ï¼šSwishã€SiLUï¼ˆGELUé¡ä¼¼ï¼‰

---

## 3.4 ãƒãƒƒã‚¯ãƒ—ãƒ­ãƒ‘ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®å°å‡º

### 3.4.1 å•é¡Œè¨­å®š

**ç›®çš„ï¼š** æå¤±é–¢æ•° $L$ ã‚’æœ€å°åŒ–ã™ã‚‹é‡ã¿ $\mathbf{W}$ ã‚’è¦‹ã¤ã‘ã‚‹

**æå¤±é–¢æ•°ã®ä¾‹ï¼š**

$$L = \frac{1}{2}\sum_{i=1}^{N}(y_i - t_i)^2 \quad \text{ï¼ˆäºŒä¹—èª¤å·®ï¼‰}$$

**å¿…è¦ãªè¨ˆç®—ï¼š**

å„é‡ã¿ $w_{jk}$ ã«é–¢ã™ã‚‹å‹¾é… $\frac{\partial L}{\partial w_{jk}}$

**å•é¡Œï¼š**

æ·±ã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ã¯æ•°ç™¾ä¸‡ã€œæ•°åå„„ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ â†’ åŠ¹ç‡çš„ãªè¨ˆç®—ãŒå¿…é ˆ

**è§£æ±ºç­–ï¼šãƒãƒƒã‚¯ãƒ—ãƒ­ãƒ‘ã‚²ãƒ¼ã‚·ãƒ§ãƒ³**

> é€£é–å¾‹ã‚’ä½¿ã£ã¦å‹¾é…ã‚’åŠ¹ç‡çš„ã«è¨ˆç®—

### 3.4.2 é€£é–å¾‹ã®å¾©ç¿’

**1å¤‰æ•°ã®é€£é–å¾‹ï¼š**

$$\frac{dz}{dx} = \frac{dz}{dy} \cdot \frac{dy}{dx}$$

**ä¾‹ï¼š**

$$z = \sin(x^2)$$

$y = x^2$ ã¨ãŠãã¨ $z = \sin(y)$

$$\frac{dz}{dx} = \cos(y) \cdot 2x = 2x\cos(x^2)$$

**å¤šå¤‰æ•°ã®é€£é–å¾‹ï¼š**

$$\frac{\partial z}{\partial x} = \sum_i \frac{\partial z}{\partial y_i} \cdot \frac{\partial y_i}{\partial x}$$

### 3.4.3 è¨ˆç®—ã‚°ãƒ©ãƒ•

**ä¾‹ï¼šç°¡å˜ãªãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯**

```
x â”€â†’ [wâ‚] â”€â†’ (aâ‚=wâ‚x) â”€â†’ [Ïƒ] â”€â†’ (hâ‚=Ïƒ(aâ‚)) â”€â†’ [wâ‚‚] â”€â†’ (aâ‚‚=wâ‚‚hâ‚) â”€â†’ [Ïƒ] â”€â†’ (y=Ïƒ(aâ‚‚)) â”€â†’ [L] â”€â†’ L
```

**é †ä¼æ’­ï¼ˆForward Passï¼‰ï¼š**

å·¦ã‹ã‚‰å³ã¸å€¤ã‚’è¨ˆç®—

$$a_1 = w_1x, \quad h_1 = \sigma(a_1), \quad a_2 = w_2h_1, \quad y = \sigma(a_2), \quad L = \frac{1}{2}(y-t)^2$$

**é€†ä¼æ’­ï¼ˆBackward Passï¼‰ï¼š**

å³ã‹ã‚‰å·¦ã¸å‹¾é…ã‚’è¨ˆç®—

$$\frac{\partial L}{\partial y} \to \frac{\partial L}{\partial a_2} \to \frac{\partial L}{\partial w_2} \to \frac{\partial L}{\partial h_1} \to \frac{\partial L}{\partial a_1} \to \frac{\partial L}{\partial w_1}$$

### 3.4.4 é€†ä¼æ’­ã®è©³ç´°è¨ˆç®—

**ã‚¹ãƒ†ãƒƒãƒ—1ï¼šå‡ºåŠ›å±¤ã®å‹¾é…**

$$\frac{\partial L}{\partial y} = \frac{\partial}{\partial y}\left[\frac{1}{2}(y-t)^2\right] = y - t$$

**ã‚¹ãƒ†ãƒƒãƒ—2ï¼šæ´»æ€§åŒ–é–¢æ•°ã®å‰**

$$\frac{\partial L}{\partial a_2} = \frac{\partial L}{\partial y} \cdot \frac{\partial y}{\partial a_2} = (y-t) \cdot \sigma'(a_2)$$

**ã‚¹ãƒ†ãƒƒãƒ—3ï¼šé‡ã¿ $w_2$ ã®å‹¾é…**

$$\frac{\partial L}{\partial w_2} = \frac{\partial L}{\partial a_2} \cdot \frac{\partial a_2}{\partial w_2} = \frac{\partial L}{\partial a_2} \cdot h_1$$

**ã‚¹ãƒ†ãƒƒãƒ—4ï¼šéš ã‚Œå±¤ã¸ã®é€†ä¼æ’­**

$$\frac{\partial L}{\partial h_1} = \frac{\partial L}{\partial a_2} \cdot \frac{\partial a_2}{\partial h_1} = \frac{\partial L}{\partial a_2} \cdot w_2$$

**ã‚¹ãƒ†ãƒƒãƒ—5ï¼šéš ã‚Œå±¤ã®æ´»æ€§åŒ–**

$$\frac{\partial L}{\partial a_1} = \frac{\partial L}{\partial h_1} \cdot \frac{\partial h_1}{\partial a_1} = \frac{\partial L}{\partial h_1} \cdot \sigma'(a_1)$$

**ã‚¹ãƒ†ãƒƒãƒ—6ï¼šé‡ã¿ $w_1$ ã®å‹¾é…**

$$\frac{\partial L}{\partial w_1} = \frac{\partial L}{\partial a_1} \cdot \frac{\partial a_1}{\partial w_1} = \frac{\partial L}{\partial a_1} \cdot x$$

### 3.4.5 ä¸€èˆ¬çš„ãªå½¢å¼

**è¨˜å·ï¼š**
- $l$ï¼šå±¤ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
- $a^{(l)}$ï¼šå±¤ $l$ ã®æ´»æ€§åŒ–å‰ã®å€¤
- $h^{(l)}$ï¼šå±¤ $l$ ã®æ´»æ€§åŒ–å¾Œã®å€¤
- $\delta^{(l)} = \frac{\partial L}{\partial a^{(l)}}$ï¼šå±¤ $l$ ã®èª¤å·®é …

**é€†ä¼æ’­ã®å…¬å¼ï¼š**

1. **å‡ºåŠ›å±¤ï¼š**
   $$\delta^{(L)} = \frac{\partial L}{\partial a^{(L)}} = \nabla_y L \odot \sigma'(a^{(L)})$$

2. **éš ã‚Œå±¤ï¼š**
   $$\delta^{(l)} = ((\mathbf{W}^{(l+1)})^\top \delta^{(l+1)}) \odot \sigma'(a^{(l)})$$

3. **é‡ã¿ã®å‹¾é…ï¼š**
   $$\frac{\partial L}{\partial \mathbf{W}^{(l)}} = \delta^{(l)} (h^{(l-1)})^\top$$

4. **ãƒã‚¤ã‚¢ã‚¹ã®å‹¾é…ï¼š**
   $$\frac{\partial L}{\partial \mathbf{b}^{(l)}} = \delta^{(l)}$$

ã“ã“ã§ $\odot$ ã¯è¦ç´ ã”ã¨ã®ç©ï¼ˆHadamardç©ï¼‰

**ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼š**

```
ã€ãƒãƒƒã‚¯ãƒ—ãƒ­ãƒ‘ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã€‘

1. é †ä¼æ’­ï¼šå„å±¤ã® a^(l), h^(l) ã‚’è¨ˆç®—
2. å‡ºåŠ›å±¤ã®èª¤å·®ï¼šÎ´^(L) ã‚’è¨ˆç®—
3. for l = L-1 down to 1:
     Î´^(l) ã‚’è¨ˆç®—ï¼ˆä¸Šã®å…¬å¼2ï¼‰
     âˆ‚L/âˆ‚W^(l), âˆ‚L/âˆ‚b^(l) ã‚’è¨ˆç®—ï¼ˆå…¬å¼3,4ï¼‰
```

**è¨ˆç®—é‡ï¼š**

- é †ä¼æ’­ï¼š $O(W)$ï¼ˆ$W$ ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•°ï¼‰
- é€†ä¼æ’­ï¼š $O(W)$

â†’ å‹¾é…è¨ˆç®—ãŒé †ä¼æ’­ã¨åŒã˜ã‚ªãƒ¼ãƒ€ãƒ¼ï¼ï¼ˆåŠ¹ç‡çš„ï¼‰

### 3.4.6 å…·ä½“ä¾‹ï¼š2å±¤ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯

**è¨­å®šï¼š**
- å…¥åŠ›ï¼š $x = 2$
- æ­£è§£ï¼š $t = 1$
- é‡ã¿ï¼š $w_1 = 0.5, w_2 = 0.5$
- æ´»æ€§åŒ–ï¼šã‚·ã‚°ãƒ¢ã‚¤ãƒ‰

**é †ä¼æ’­ï¼š**

$$a_1 = w_1 x = 0.5 \times 2 = 1$$
$$h_1 = \sigma(1) = \frac{1}{1+e^{-1}} \approx 0.731$$
$$a_2 = w_2 h_1 = 0.5 \times 0.731 = 0.366$$
$$y = \sigma(0.366) \approx 0.590$$
$$L = \frac{1}{2}(0.590 - 1)^2 = 0.084$$

**é€†ä¼æ’­ï¼š**

$$\frac{\partial L}{\partial y} = 0.590 - 1 = -0.410$$

$$\frac{\partial L}{\partial a_2} = -0.410 \times \sigma'(0.366) = -0.410 \times 0.590 \times 0.410 \approx -0.099$$

$$\frac{\partial L}{\partial w_2} = -0.099 \times 0.731 \approx -0.072$$

$$\frac{\partial L}{\partial h_1} = -0.099 \times 0.5 = -0.050$$

$$\frac{\partial L}{\partial a_1} = -0.050 \times \sigma'(1) \approx -0.050 \times 0.197 = -0.010$$

$$\frac{\partial L}{\partial w_1} = -0.010 \times 2 = -0.020$$

**æ›´æ–°ï¼ˆå­¦ç¿’ç‡ $\eta = 0.1$ï¼‰ï¼š**

$$w_1 \leftarrow 0.5 - 0.1 \times (-0.020) = 0.502$$
$$w_2 \leftarrow 0.5 - 0.1 \times (-0.072) = 0.507$$

æå¤±ãŒæ¸›å°‘ã™ã‚‹æ–¹å‘ã«é‡ã¿ãŒæ›´æ–°ã•ã‚Œã‚‹ï¼

---

## 3.5 å‹¾é…æ¶ˆå¤±ãƒ»çˆ†ç™ºå•é¡Œã®ç†è«–çš„è§£æ

### 3.5.1 å‹¾é…æ¶ˆå¤±å•é¡Œ

**å•é¡Œï¼š**

æ·±ã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ã€åˆæœŸå±¤ã®å‹¾é…ãŒæ¥µã‚ã¦å°ã•ããªã‚‹ç¾è±¡

**æ•°å­¦çš„åˆ†æï¼š**

Lå±¤ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ã€ç¬¬1å±¤ã®é‡ã¿ã®å‹¾é…ï¼š

$$\frac{\partial L}{\partial \mathbf{W}^{(1)}} = \delta^{(1)}(h^{(0)})^\top$$

ã“ã“ã§

$$\delta^{(1)} = ((\mathbf{W}^{(2)})^\top \cdots (\mathbf{W}^{(L)})^\top \delta^{(L)}) \odot \sigma'(a^{(1)}) \odot \cdots$$

**é€£é–ç©ï¼š**

$$\delta^{(1)} \propto \prod_{l=2}^{L} \mathbf{W}^{(l)} \prod_{l=1}^{L} \sigma'(a^{(l)})$$

**å•é¡Œã®ç™ºç”Ÿï¼š**

ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°ã®å ´åˆï¼š

$$\sigma'(x) = \sigma(x)(1-\sigma(x)) \leq \frac{1}{4}$$

Lå±¤ã§ï¼š

$$|\delta^{(1)}| \lesssim \left(\frac{1}{4}\right)^L \to 0 \quad (L \to \infty)$$

**è¦–è¦šåŒ–ï¼š**

```
å±¤   å‹¾é…ã®å¤§ãã•
L    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  1.0
L-1  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ        0.5
L-2  â–ˆâ–ˆâ–ˆ           0.25
L-3  â–ˆ             0.125
...
1    Â·             â‰ˆ0 (æ¶ˆå¤±ï¼)
```

**å½±éŸ¿ï¼š**

> åˆæœŸå±¤ãŒå­¦ç¿’ã—ãªã„ â†’ æ·±ã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒè¨“ç·´ã§ããªã„

### 3.5.2 å‹¾é…çˆ†ç™ºå•é¡Œ

**å•é¡Œï¼š**

å‹¾é…ãŒæŒ‡æ•°çš„ã«å¤§ãããªã‚‹ç¾è±¡

**ç™ºç”Ÿæ¡ä»¶ï¼š**

$$\|\mathbf{W}^{(l)}\| > 1 \quad \text{ã‹ã¤} \quad \sigma'(a^{(l)}) \approx 1$$

ã“ã®ã¨ãï¼š

$$|\delta^{(1)}| \gtrsim \left(\|\mathbf{W}\|\right)^L \to \infty \quad (L \to \infty)$$

**è¦–è¦šåŒ–ï¼š**

```
æ›´æ–°ã‚¹ãƒ†ãƒƒãƒ—ã§ã®é‡ã¿ã®å¤‰åŒ–

æ­£å¸¸:  w â†’ w+Î”w  (Î”wãŒé©åˆ‡)

çˆ†ç™º:  w â†’ w+å·¨å¤§ãªÎ”w
          â†“
       ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒç™ºæ•£
          â†“
       NaN (æ•°å€¤ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼)
```

**ç—‡çŠ¶ï¼š**
- æå¤±ãŒ NaN ã«ãªã‚‹
- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒç•°å¸¸ãªå€¤
- è¨“ç·´ãŒä¸å®‰å®š

### 3.5.3 è§£æ±ºç­–

#### 1. é©åˆ‡ãªæ´»æ€§åŒ–é–¢æ•°

**ReLUã®ä½¿ç”¨ï¼š**

$$\text{ReLU}'(x) = \begin{cases} 1 & x > 0 \\\ 0 & x \leq 0 \end{cases}$$

- æ­£ã®é ˜åŸŸã§å‹¾é…ãŒ1 â†’ æ¶ˆå¤±ã—ãªã„
- å¤šãã®ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ãŒ0 â†’ äº‹å®Ÿä¸Šã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒæµ…ã„

#### 2. é‡ã¿ã®åˆæœŸåŒ–

**Xavierï¼ˆGlorotï¼‰åˆæœŸåŒ–ï¼š**

$$w_{ij} \sim \mathcal{N}\left(0, \frac{2}{n_{\text{in}} + n_{\text{out}}}\right)$$

ã“ã“ã§ $n_{\text{in}}, n_{\text{out}}$ ã¯å…¥å‡ºåŠ›ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³æ•°

**ç›®çš„ï¼š** å„å±¤ã§åˆ†æ•£ã‚’ä¿ã¤

**HeåˆæœŸåŒ–ï¼ˆReLUç”¨ï¼‰ï¼š**

$$w_{ij} \sim \mathcal{N}\left(0, \frac{2}{n_{\text{in}}}\right)$$

**ç†è«–çš„èƒŒæ™¯ï¼š**

å„å±¤ã®å‡ºåŠ›ã®åˆ†æ•£ï¼š

$$\text{Var}(a^{(l)}) = n_{\text{in}} \cdot \text{Var}(w) \cdot \text{Var}(h^{(l-1)})$$

åˆæœŸåŒ–ã§ $\text{Var}(w) = \frac{1}{n_{\text{in}}}$ ã¨ã™ã‚‹ã¨ï¼š

$$\text{Var}(a^{(l)}) = \text{Var}(h^{(l-1)})$$

â†’ åˆ†æ•£ãŒä¿ãŸã‚Œã‚‹ï¼

#### 3. ãƒãƒƒãƒæ­£è¦åŒ–

**ã‚¢ã‚¤ãƒ‡ã‚¢ï¼š**

å„å±¤ã®å‡ºåŠ›ã‚’æ­£è¦åŒ–ã—ã¦ã€åˆ†å¸ƒã‚’å®‰å®šã•ã›ã‚‹

$$\hat{h} = \frac{h - \mathbb{E}[h]}{\sqrt{\text{Var}(h) + \epsilon}}$$

**åŠ¹æœï¼š**
- å‹¾é…ã®æµã‚Œã‚’æ”¹å–„
- å­¦ç¿’ç‡ã‚’å¤§ããã§ãã‚‹
- æ­£å‰‡åŒ–åŠ¹æœ

#### 4. æ®‹å·®æ¥ç¶šï¼ˆResNetï¼‰

**ã‚¢ã‚¤ãƒ‡ã‚¢ï¼š**

$$h^{(l+1)} = h^{(l)} + F(h^{(l)})$$

ã‚¹ã‚­ãƒƒãƒ—æ¥ç¶šã«ã‚ˆã‚Šã€å‹¾é…ãŒç›´æ¥æµã‚Œã‚‹çµŒè·¯ã‚’ç¢ºä¿

**è¦–è¦šåŒ–ï¼š**

```
h^(l) â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â†’ h^(l+1)
        â”‚            â”‚
        â””â†’ [å±¤] â†’ F â”€â”˜ (åŠ ç®—)
```

**å‹¾é…ã®æµã‚Œï¼š**

$$\frac{\partial L}{\partial h^{(l)}} = \frac{\partial L}{\partial h^{(l+1)}} \left(1 + \frac{\partial F}{\partial h^{(l)}}\right)$$

æœ€ä½ã§ã‚‚å‹¾é…ãŒ1å€ã§ä¼ã‚ã‚‹ï¼

**LLMã§ã®å¿œç”¨ï¼š**

Transformerã®å„ã‚µãƒ–å±¤ã§æ®‹å·®æ¥ç¶šã‚’ä½¿ç”¨

#### 5. å‹¾é…ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°

**ã‚¢ã‚¤ãƒ‡ã‚¢ï¼š**

å‹¾é…ã®ãƒãƒ«ãƒ ãŒé–¾å€¤ã‚’è¶…ãˆãŸã‚‰ã€ã‚¹ã‚±ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³

$$\mathbf{g} \leftarrow \begin{cases}
\mathbf{g} & \text{if } \|\mathbf{g}\| \leq \theta \\
\frac{\theta}{\|\mathbf{g}\|}\mathbf{g} & \text{otherwise}
\end{cases}$$

**åŠ¹æœï¼š**

å‹¾é…çˆ†ç™ºã‚’é˜²ã

**LLMã§ã®ä½¿ç”¨ï¼š**

ã»ã¼ã™ã¹ã¦ã®LLMè¨“ç·´ã§æ¨™æº–çš„ã«ä½¿ç”¨

---

## æœ¬ç« ã®ã¾ã¨ã‚

### å­¦ã‚“ã ã“ã¨

âœ… **ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³**
- ç·šå½¢åˆ†é›¢å¯èƒ½ãªå•é¡Œã®ã¿è§£ã‘ã‚‹
- XORå•é¡Œã¯è§£ã‘ãªã„ï¼ˆé™ç•Œï¼‰

âœ… **å¤šå±¤ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³**
- å±¤ã‚’é‡ã­ã‚‹ã“ã¨ã§éç·šå½¢å•é¡Œã‚’è§£æ±º
- æ±ç”¨è¿‘ä¼¼å®šç†ï¼šä»»æ„ã®é–¢æ•°ã‚’è¿‘ä¼¼å¯èƒ½

âœ… **æ´»æ€§åŒ–é–¢æ•°**
- ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰ã€tanhï¼šå‹¾é…æ¶ˆå¤±ã®å•é¡Œ
- ReLUï¼šåŠ¹ç‡çš„ã€å‹¾é…æ¶ˆå¤±ã‚’è»½æ¸›
- GELUï¼šLLMã§æ¨™æº–çš„

âœ… **ãƒãƒƒã‚¯ãƒ—ãƒ­ãƒ‘ã‚²ãƒ¼ã‚·ãƒ§ãƒ³**
- é€£é–å¾‹ã§åŠ¹ç‡çš„ã«å‹¾é…è¨ˆç®—
- è¨ˆç®—é‡ã¯é †ä¼æ’­ã¨åŒã‚ªãƒ¼ãƒ€ãƒ¼

âœ… **å‹¾é…æ¶ˆå¤±ãƒ»çˆ†ç™ºå•é¡Œ**
- æ·±ã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®èª²é¡Œ
- è§£æ±ºç­–ï¼šReLUã€é©åˆ‡ãªåˆæœŸåŒ–ã€ãƒãƒƒãƒæ­£è¦åŒ–ã€æ®‹å·®æ¥ç¶š

### é‡è¦ãªå…¬å¼

| æ¦‚å¿µ | å…¬å¼ |
|------|------|
| ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰ | $\sigma(x) = \frac{1}{1+e^{-x}}$ |
| ReLU | $\text{ReLU}(x) = \max(0, x)$ |
| é †ä¼æ’­ | $h^{(l)} = \sigma(\mathbf{W}^{(l)}h^{(l-1)} + \mathbf{b}^{(l)})$ |
| èª¤å·®é€†ä¼æ’­ | $\delta^{(l)} = ((\mathbf{W}^{(l+1)})^\top\delta^{(l+1)}) \odot \sigma'(a^{(l)})$ |
| é‡ã¿ã®å‹¾é… | $\frac{\partial L}{\partial \mathbf{W}^{(l)}} = \delta^{(l)}(h^{(l-1)})^\top$ |

### æ¬¡ç« ã®äºˆå‘Š

ç¬¬4ç« ã§ã¯ã€ã„ã‚ˆã„ã‚ˆLLMã®ä¸­æ ¸ã§ã‚ã‚‹**Transformerã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**ã‚’å­¦ã³ã¾ã™ï¼š
- ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³æ©Ÿæ§‹
- ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³
- ä½ç½®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
- Layer Normalization

ã“ã‚Œã¾ã§å­¦ã‚“ã ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®åŸºç¤ã®ä¸Šã«ã€é©æ–°çš„ãªTransformerã®ä»•çµ„ã¿ã‚’ç†è§£ã—ã¦ã„ãã¾ã™ã€‚

---

## ç·´ç¿’å•é¡Œ

### å•é¡Œ1ï¼šXORã®å®Ÿè£…
2å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§XORã‚²ãƒ¼ãƒˆã‚’å®Ÿè£…ã›ã‚ˆã€‚éš ã‚Œå±¤ã«2ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ã€æ´»æ€§åŒ–é–¢æ•°ã¯ã‚¹ãƒ†ãƒƒãƒ—é–¢æ•°ã‚’ä½¿ç”¨ã€‚

### å•é¡Œ2ï¼šæ´»æ€§åŒ–é–¢æ•°ã®å¾®åˆ†
ä»¥ä¸‹ã®æ´»æ€§åŒ–é–¢æ•°ã®å°é–¢æ•°ã‚’æ±‚ã‚ã‚ˆï¼š
1. $\text{ReLU}(x) = \max(0, x)$
2. $\text{Leaky ReLU}(x) = \max(0.01x, x)$

### å•é¡Œ3ï¼šãƒãƒƒã‚¯ãƒ—ãƒ­ãƒ‘ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
æ¬¡ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ $\frac{\partial L}{\partial w_1}$ ã‚’è¨ˆç®—ã›ã‚ˆï¼š
- $a_1 = w_1x$, $h_1 = a_1$ï¼ˆæ’ç­‰é–¢æ•°ï¼‰
- $a_2 = w_2h_1$, $y = a_2$ï¼ˆæ’ç­‰é–¢æ•°ï¼‰
- $L = \frac{1}{2}(y-t)^2$

ä¸ãˆã‚‰ã‚ŒãŸå€¤ï¼š $x=2, t=5, w_1=1, w_2=1$

### å•é¡Œ4ï¼šå‹¾é…æ¶ˆå¤±
10å±¤ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§å„å±¤ã®æ´»æ€§åŒ–é–¢æ•°ãŒã‚·ã‚°ãƒ¢ã‚¤ãƒ‰ã€ $\sigma'(a) = 0.25$ ã¨ã™ã‚‹ã€‚ç¬¬1å±¤ã®å‹¾é…ãŒç¬¬10å±¤ã®å‹¾é…ã®ä½•å€ã«ãªã‚‹ã‹è¨ˆç®—ã›ã‚ˆã€‚

### è§£ç­”

**å•é¡Œ1:**

éš ã‚Œå±¤ï¼š
- $h_1 = \text{step}(x_1 + x_2 - 1.5)$ ï¼ˆANDçš„ï¼‰
- $h_2 = \text{step}(-x_1 - x_2 + 0.5)$ ï¼ˆNORçš„ï¼‰

å‡ºåŠ›å±¤ï¼š
- $y = \text{step}(-h_1 + h_2 + 0.5)$

ï¼ˆä»–ã®è§£ã‚‚å­˜åœ¨ï¼‰

**å•é¡Œ2:**
1. $\text{ReLU}'(x) = \begin{cases} 1 & x > 0 \\ 0 & x \leq 0 \end{cases}$

2. $\text{Leaky ReLU}'(x) = \begin{cases} 1 & x > 0 \\ 0.01 & x \leq 0 \end{cases}$

**å•é¡Œ3:**

é †ä¼æ’­ï¼š $a_1 = 2, h_1 = 2, a_2 = 2, y = 2, L = \frac{1}{2}(2-5)^2 = 4.5$

é€†ä¼æ’­ï¼š
$$\frac{\partial L}{\partial y} = 2 - 5 = -3$$
$$\frac{\partial L}{\partial a_2} = -3$$
$$\frac{\partial L}{\partial h_1} = -3 \times 1 = -3$$
$$\frac{\partial L}{\partial a_1} = -3$$
$$\frac{\partial L}{\partial w_1} = -3 \times 2 = -6$$

**å•é¡Œ4:**

$$\frac{\delta^{(1)}}{\delta^{(10)}} \approx (0.25)^9 \approx 3.8 \times 10^{-6}$$

ç´„100ä¸‡åˆ†ã®1ã«æ¸›è¡°ï¼ï¼ˆå‹¾é…æ¶ˆå¤±ï¼‰

---

**ğŸ“– å‰ç« ï¼š[ç¬¬2ç«  æ•°å­¦çš„åŸºç¤](./ç¬¬2ç« _æ•°å­¦çš„åŸºç¤.md)**  
**ğŸ“– æ¬¡ç« ï¼š[ç¬¬4ç«  Transformerã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®åŸºç¤](./ç¬¬4ç« _Transformerã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®åŸºç¤.md)**
